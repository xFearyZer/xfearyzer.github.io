<!DOCTYPE html>
<html>
<head>
  <title>Get Key Tool</title>
  <style>
    body { font-family: Arial; text-align: center; margin-top: 50px; }
    button { padding: 10px 20px; background: #4285f4; color: white; border: none; }
  </style>
</head>
<body>
  <h1>Key Tool</h1>
  <button id="getKeyBtn">Get Key</button>
  <p id="keyDisplay"></p>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  
  <script>
    // Config Firebase của bạn
    const firebaseConfig = {
      apiKey: "AIzaSyABCD...",
      projectId: "key-management-system-xfaz",
      authDomain: "key-management-system-xfaz.firebaseapp.com"
    };

    // Khởi tạo Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Hàm tạo key ngẫu nhiên
    function generateKey() {
      return 'KEY-' + Math.random().toString(36).substr(2, 10).toUpperCase();
    }

    // Xử lý khi bấm Get Key
    document.getElementById('getKeyBtn').addEventListener('click', async () => {
      const key = generateKey();
      
      // Lưu key lên Firestore
      await db.collection("keys").add({
        key: key,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        status: "active",
        ip: await fetch('https://api.ipify.org?format=json').then(res => res.json()).then(data => data.ip)
      });

      document.getElementById('keyDisplay').textContent = `Key của bạn: ${key}`;
    });
  </script>
</body>
</html>
